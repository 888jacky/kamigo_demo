[
  <% if @keyword.present? %>
  {
    "type": "text",
    "text": "您要查詢(<%= @keyword %>)的關鍵字題目如下。"
  },
  <% end %>
  {
    "type": "flex",
    "altText": "攤商查詢",
    "contents":{
      "type": "carousel",
      "contents": [
        <% @markets1.each do|market| %>
        {
          "type": "bubble",
          "hero": {
            "type": "image",
            "size": "full",
            "aspectRatio": "320:310",
            "aspectMode": "cover",
            "url": "<%= market[:圖片] %>"
          },
          "body": {
            "type": "box",
            "layout": "vertical",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "<%= market[:攤商] %>",
                "wrap": true,
                "weight": "bold",
                "size": "xl",
                "color": "#0900e6",
                "align": "center"
              },
              {
                "type": "box",
                "layout": "vertical",
                "contents": [
                  {
                    "type": "text",
                    "text": "<%= market[:服務] %>",
                    "wrap": true,
                    "weight": "bold",
                    "size": "lg",
                    "flex": 0,
                    "color": "#050403"
                  }
                ],
                "height": "125px",
                "spacing": "xs"
              },
              {
                "type": "box",
                "layout": "vertical",
                "contents": [
                  {
                    "type": "button",
                    "action": {
                      "type": "postback",
                      "label": "聯絡資訊",
                      "data": "<%= market[:電話] %>"
                    },
                    "style": "primary",
                    "color": "#FF0000",
                    "height": "sm"
                  }
                ],
                "height": "60px"
              }
            ]
          }
        }<%= "," if market != @markets1.last %>
        <% end %>
      ]
    }
}
]